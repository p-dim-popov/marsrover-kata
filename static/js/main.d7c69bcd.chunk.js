(this["webpackJsonpmarsrover-kata"]=this["webpackJsonpmarsrover-kata"]||[]).push([[0],{18:function(t,e,i){},19:function(t,e,i){},21:function(t,e,i){"use strict";i.r(e);var n,o=i(1),s=i.n(o),r=i(10),c=i.n(r),a=(i(18),i(19),i(12)),u=i(7),d=i(3),h=i(9),l=i(13),f=i(0),b=["type"];!function(t){t.Rover="R",t.Obstacle="X",t.Visited="V",t.NotVisited="O"}(n||(n={}));var v,O=function(t){var e=t.type,i=Object(l.a)(t,b);return Object(f.jsx)("div",Object(h.a)(Object(h.a)({className:"p-2 h-10 w-10 bg-gray-900 rounded-full flex items-center justify-center"},i),{},{children:e}))},j=i(2),w=i(5),y=function(){function t(e,i){Object(j.a)(this,t),this.x=e,this.y=i}return Object(w.a)(t,[{key:"equals",value:function(t){return!!t&&this.x===t.x&&this.y===t.y}},{key:"clone",value:function(){return t.clone(this)}}],[{key:"clone",value:function(e){return new t(e.x,e.y)}}]),t}(),p=i(11),x=function(t){return null===t||void 0===t||Number.isNaN(t)||""===t};!function(t){t.East="E",t.West="W",t.North="N",t.South="S"}(v||(v={}));var g,k=[v.East,v.South,v.West,v.North],m=function(){function t(e,i){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(Object(j.a)(this,t),this.position=void 0,this.direction=v.North,this.hasObstacles=!1,"string"===typeof e){var o=t.parse(e);this.position=y.clone(o.position),this.direction=o.direction,this.hasObstacles=o.hasObstacles}else this.position=new y(e.x,e.y),this.direction=i,this.hasObstacles=n}return Object(w.a)(t,[{key:"toString",value:function(){var t="".concat(this.position.x,":").concat(this.position.y,":").concat(this.direction);return this.hasObstacles&&(t="O:"+t),t}}],[{key:"parse",value:function(e){if(!e)throw new Error("Not valid coordinates!");var i=!1;e.startsWith("O:")&&(i=!0,e=e.replace("O:",""));var n=e.split(":"),o=+n[0],s=+n[1],r=n[2];if(x(o)||x(s)||x(r)||!Object.values(v).includes(r))throw new Error("Not valid coordinates!");return new t(new y(o,s),r,i)}}]),t}();!function(t){t.Move="M",t.RotateLeft="L",t.RotateRight="R"}(g||(g={}));var R,N=function(){function t(e){Object(j.a)(this,t),this.grid=e,this.coordinates=new m("0:0:N")}return Object(w.a)(t,[{key:"tryMoveTowardsPoint",value:function(t,e){this.grid.hasObstacleOnPoint(t)?this.coordinates.hasObstacles=!0:(this.coordinates.hasObstacles=!1,e())}},{key:"moveForward",value:function(){var t=this;switch(this.coordinates.direction){case v.East:var e=(this.coordinates.position.x+1)%this.grid.cols;this.tryMoveTowardsPoint(new y(e,this.coordinates.position.y),(function(){return t.coordinates.position.x=e}));break;case v.West:var i=(this.coordinates.position.x?this.coordinates.position.x:this.grid.cols)-1;this.tryMoveTowardsPoint(new y(i,this.coordinates.position.y),(function(){return t.coordinates.position.x=i}));break;case v.North:var n=(this.coordinates.position.y+1)%this.grid.rows;this.tryMoveTowardsPoint(new y(this.coordinates.position.x,n),(function(){return t.coordinates.position.y=n}));break;case v.South:var o=(this.coordinates.position.y?this.coordinates.position.y:this.grid.rows)-1;this.tryMoveTowardsPoint(new y(this.coordinates.position.x,o),(function(){return t.coordinates.position.y=o}));break;default:throw new Error("Unknown direction!")}}},{key:"execute",value:function(t){if(!t)throw new Error("Command/s is not valid!");var e,i=Object(p.a)("string"===typeof t?t.split(""):t);try{for(i.s();!(e=i.n()).done;){switch(e.value){case g.Move:this.moveForward();break;case g.RotateRight:this.coordinates.direction=k[(k.indexOf(this.coordinates.direction)+1)%k.length],this.coordinates.hasObstacles=!1;break;case g.RotateLeft:var n=k.indexOf(this.coordinates.direction);this.coordinates.direction=k[(n||k.length)-1],this.coordinates.hasObstacles=!1;break;default:throw new Error("Command type not known!")}}}catch(o){i.e(o)}finally{i.f()}return this.coordinates.toString()}}]),t}(),E=function(t){var e=t.children,i=t.onClick;return Object(f.jsx)("button",{className:"bg-gray-300 text-black rounded m-2",onClick:function(t){return null===i||void 0===i?void 0:i()},children:e})},C={Move:["k","ArrowUp"],RotateLeft:["j","ArrowLeft"],RotateRight:["l","ArrowRight"]},L=(R={},Object(d.a)(R,v.East,""),Object(d.a)(R,v.North,"-rotate-90"),Object(d.a)(R,v.West,"rotate-180"),Object(d.a)(R,v.South,"rotate-90"),R),M=function(t){var e=Object(o.useRef)(new N(t.grid)),i=Object(o.useState)([e.current.coordinates.position.clone()]),s=Object(u.a)(i,2),r=s[0],c=s[1],d=function(){var t=Object(o.useState)(1),e=Object(u.a)(t,2),i=e[0],n=e[1];return function(){return n(i+1)}}(),h=Object(o.useCallback)((function(){e.current.execute([g.Move]),c([].concat(Object(a.a)(r),[e.current.coordinates.position.clone()]))}),[r]),l=Object(o.useCallback)((function(t){e.current.execute([t]),d()}),[d]);Object(o.useEffect)((function(){var t=function(t){C.Move.includes(t.key)?h():C.RotateLeft.includes(t.key)?l(g.RotateLeft):C.RotateRight.includes(t.key)&&l(g.RotateRight)};return window.addEventListener("keydown",t),function(){window.removeEventListener("keydown",t)}}),[h,l]);var b=Object(o.useCallback)((function(i){return t.grid.hasObstacleOnPoint(i)?n.Obstacle:e.current.coordinates.position.equals(i)?n.Rover:r.some((function(t){return t.equals(i)}))?n.Visited:n.NotVisited}),[t.grid,r]),v=Array(t.grid.cols).fill(null).map((function(i,o){var s=Array(t.grid.rows).fill(null).map((function(t,i){var s="e_".concat(o,"_").concat(i),r=new y(o,i),c=b(r);return Object(f.jsx)("div",{className:c===n.Rover?"transform ".concat(L[e.current.coordinates.direction]):"",children:Object(f.jsx)(O,{type:c,"data-testid":s})},s)}));return Object(f.jsx)("div",{className:"flex flex-col-reverse",children:s},o)}));return Object(f.jsxs)("div",{className:"flex flex-col items-center space-x-5 space-y-5",children:[e.current.coordinates.hasObstacles&&Object(f.jsx)("span",{children:"BLOCKED BY OBSTACLE!"}),Object(f.jsx)("div",{className:"flex",children:v}),Object(f.jsxs)("div",{className:"flex flex-row justify-between content-center",children:[Object(f.jsx)(E,{onClick:function(){return l(g.RotateLeft)},children:"Rotate Left"}),Object(f.jsx)(E,{onClick:h,children:"Move Forward"}),Object(f.jsx)(E,{onClick:function(){return l(g.RotateRight)},children:"Rotate Right"})]})]})},S=function t(e,i,n){var o=this;Object(j.a)(this,t),this.rows=void 0,this.cols=void 0,this.obstacles=void 0,this.hasObstacleOnPoint=function(t){return o.obstacles.some((function(e){return e.x===t.x&&e.y===t.y}))},this.rows=e,this.cols=e,this.obstacles=null!==n&&void 0!==n?n:[],"number"===typeof i?this.cols=i:Array.isArray(i)&&(this.obstacles=i)};var A=function(){return Object(f.jsx)("div",{className:"App",children:Object(f.jsx)("header",{className:"App-header",children:Object(f.jsx)(M,{grid:new S(5,7,[new y(1,3)])})})})},P=function(t){t&&t instanceof Function&&i.e(3).then(i.bind(null,22)).then((function(e){var i=e.getCLS,n=e.getFID,o=e.getFCP,s=e.getLCP,r=e.getTTFB;i(t),n(t),o(t),s(t),r(t)}))};c.a.render(Object(f.jsx)(s.a.StrictMode,{children:Object(f.jsx)(A,{})}),document.getElementById("root")),P()}},[[21,1,2]]]);
//# sourceMappingURL=main.d7c69bcd.chunk.js.map